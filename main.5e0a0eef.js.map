{"version":3,"sources":["scripts/main.js"],"names":["board","rowsCount","columnsCount","score","document","querySelector","cell","querySelectorAll","button","winMessage","loseMessage","startMessage","setGame","i","r","c","id","num","updateTile","setRandom","addEventListener","handleChange","hasEmptyTile","isFound","Math","floor","random","tile","getElementById","innerText","classList","add","value","textContext","remove","textContent","e","code","slideLeftAndRight","slideUpAndDown","gameLose","gameWin","filterZero","row","filter","slide","newRow","length","push","left","reverse","up","isHorizontalMoveAvailable","isVerticalMoveAvailable","removeEventListener"],"mappings":"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","file":"main.5e0a0eef.js","sourceRoot":"../src","sourcesContent":["'use strict';\n\nlet board;\nconst rowsCount = 4;\nconst columnsCount = 4;\nconst score = document.querySelector('.game-score');\nconst cell = document.querySelectorAll('.field-cell');\nconst button = document.querySelector('.button');\n\nconst winMessage = document.querySelector('.message-win');\nconst loseMessage = document.querySelector('.message-lose');\nconst startMessage = document.querySelector('.message-start');\n\nbutton.addEventListener('click', () => {\n  if (button.textContext === 'Start') {\n    button.classList.remove('start');\n    button.classList.add('restart');\n    button.textContent = 'Restart';\n  } else {\n    button.classList.remove('restart');\n    button.classList.add('start');\n    button.textContent = 'Start';\n  }\n\n  score.textContext = '0';\n  startMessage.classList.add('hidden');\n  loseMessage.classList.add('hidden');\n  startMessage.classList.add('hidden');\n\n  setGame();\n});\n\nfunction setGame() {\n  board = [\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n  ];\n\n  let i = 0;\n\n  for (let r = 0; r < rowsCount; r++) {\n    for (let c = 0; c < columnsCount; c++) {\n      cell[i].id = `${r}-${c}`;\n\n      const num = board[r][c];\n\n      updateTile(cell[i], num);\n      i++;\n    }\n  }\n\n  setRandom();\n  setRandom();\n  document.addEventListener('keyup', handleChange);\n}\n\nfunction hasEmptyTile() {\n  for (let r = 0; r < rowsCount; r++) {\n    for (let c = 0; c < columnsCount; c++) {\n      if (board[r][c] === 0) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction setRandom() {\n  if (!hasEmptyTile()) {\n    return;\n  }\n\n  let isFound = false;\n\n  while (!isFound) {\n    const r = Math.floor(Math.random() * rowsCount);\n    const c = Math.floor(Math.random() * columnsCount);\n\n    if (board[r][c] === 0) {\n      board[r][c] = Math.random() < 0.1 ? 4 : 2;\n\n      const tile = document.getElementById(`${r}-${c}`);\n\n      tile.innerText = '2';\n      tile.classList.add('field-cell--2');\n      isFound = true;\n    }\n  }\n}\n\nfunction updateTile(tile, num) {\n  tile.innerText = '';\n  tile.classList.value = '';\n  tile.classList.add('field-cell');\n\n  if (num > 0) {\n    tile.innerText = num;\n    tile.classList.add(`field-cell--${num}`);\n  }\n}\n\nconst handleChange = (e) => {\n  switch (e.code) {\n    case 'ArrowLeft': {\n      slideLeftAndRight(true);\n      setRandom();\n\n      break;\n    }\n\n    case 'ArrowRight': {\n      slideLeftAndRight(false);\n      setRandom();\n\n      break;\n    }\n\n    case 'ArrowUp': {\n      slideUpAndDown(true);\n      setRandom();\n\n      break;\n    }\n\n    case 'ArrowDown': {\n      slideUpAndDown(false);\n      setRandom();\n\n      break;\n    }\n  }\n\n  gameLose();\n  gameWin();\n};\n\nfunction filterZero(row) {\n  return row.filter(num => num !== 0);\n}\n\nfunction slide(row) {\n  let newRow = filterZero(row);\n\n  for (let i = 0; i < newRow.length; i++) {\n    if (newRow[i] === newRow[i + 1]) {\n      newRow[i] *= 2;\n      newRow[i + 1] = 0;\n      score.textContent = `${+score.textContent + newRow[i]}`;\n    }\n  }\n\n  newRow = filterZero(newRow);\n\n  while (newRow.length < columnsCount) {\n    newRow.push(0);\n  }\n\n  return newRow;\n}\n\nfunction slideLeftAndRight(left) {\n  for (let r = 0; r < rowsCount; r++) {\n    let row = board[r];\n\n    if (left) {\n      row = slide(row);\n      board[r] = row;\n    } else {\n      row.reverse();\n      row = slide(row);\n      row.reverse();\n      board[r] = row;\n    }\n\n    for (let c = 0; c < columnsCount; c++) {\n      const tile = document.getElementById(`${r}-${c}`);\n      const num = board[r][c];\n\n      updateTile(tile, num);\n    }\n  }\n}\n\nfunction slideUpAndDown(up) {\n  for (let c = 0; c < columnsCount; c++) {\n    let row = [board[0][c],\n      board[1][c],\n      board[2][c],\n      board[3][c]];\n\n    if (up) {\n      row = slide(row);\n    } else {\n      row.reverse();\n      row = slide(row);\n      row.reverse();\n    }\n\n    for (let r = 0; r < columnsCount; r++) {\n      board[r][c] = row[r];\n\n      const tile = document.getElementById(`${r}-${c}`);\n      const num = board[r][c];\n\n      updateTile(tile, num);\n    }\n  }\n};\n\nfunction gameLose() {\n  if (\n    hasEmptyTile()\n    || isHorizontalMoveAvailable()\n    || isVerticalMoveAvailable()\n  ) {\n    return;\n  }\n\n  loseMessage.classList.remove('hidden');\n  document.removeEventListener('keyup', handleChange);\n}\n\nfunction isHorizontalMoveAvailable() {\n  for (let r = 0; r < rowsCount; r++) {\n    const row = board[r];\n\n    for (let c = 0; c < columnsCount - 1; c++) {\n      if (row[c] === row[c + 1]) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction isVerticalMoveAvailable() {\n  for (let r = 0; r < rowsCount - 1; r++) {\n    for (let c = 0; c < columnsCount; c++) {\n      if (board[r][c] === board[r + 1][c]) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction gameWin() {\n  for (let r = 0; r < rowsCount; r++) {\n    for (let c = 0; c < columnsCount; c++) {\n      if (board[r][c] === 2048) {\n        winMessage.classList.remove('hidden');\n      }\n    }\n  }\n}\n"]}